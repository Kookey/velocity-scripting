<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at Apr 3, 2013
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="The MyBatis Team" />
    <meta name="Date-Revision-yyyymmdd" content="20130403" />
    <meta http-equiv="Content-Language" content="en" />
    <title>MyBatis-Velocity - 
    MyBatis-Velocity</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>MyBatis Velocity</h2>
                </div>
                      </div>
        <div class="pull-right">                                <a href="../../" id="bannerRight" title="MyBatis logo">
                                                                                        <img src="http://mybatis.github.com/images/mybatis-logo.png"  alt="MyBatis logo"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 03 April 2013</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 1.0-SNAPSHOT</li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Documentation</li>
                                
      <li class="active">
    
            <a href="#"><i class="none"></i>Quick start</a>
          </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                                    
      <li>
    
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-down"></i>
        Project Information</a>
                    <ul class="nav nav-list">
                      
      <li class="active">
    
            <a href="#"><i class="none"></i>About</a>
          </li>
                      
      <li>
    
                          <a href="team-list.html" title="Project Team">
          <i class="none"></i>
        Project Team</a>
            </li>
                      
      <li>
    
                          <a href="dependency-info.html" title="Dependency Information">
          <i class="none"></i>
        Dependency Information</a>
            </li>
                      
      <li>
    
                          <a href="plugins.html" title="Project Plugins">
          <i class="none"></i>
        Project Plugins</a>
            </li>
                      
      <li>
    
                          <a href="integration.html" title="Continuous Integration">
          <i class="none"></i>
        Continuous Integration</a>
            </li>
                      
      <li>
    
                          <a href="issue-tracking.html" title="Issue Tracking">
          <i class="none"></i>
        Issue Tracking</a>
            </li>
                      
      <li>
    
                          <a href="source-repository.html" title="Source Repository">
          <i class="none"></i>
        Source Repository</a>
            </li>
                      
      <li>
    
                          <a href="license.html" title="Project License">
          <i class="none"></i>
        Project License</a>
            </li>
                      
      <li>
    
                          <a href="plugin-management.html" title="Plugin Management">
          <i class="none"></i>
        Plugin Management</a>
            </li>
                      
      <li>
    
                          <a href="distribution-management.html" title="Distribution Management">
          <i class="none"></i>
        Distribution Management</a>
            </li>
                      
      <li>
    
                          <a href="project-summary.html" title="Project Summary">
          <i class="none"></i>
        Project Summary</a>
            </li>
                      
      <li>
    
                          <a href="mail-lists.html" title="Mailing Lists">
          <i class="none"></i>
        Mailing Lists</a>
            </li>
                      
      <li>
    
                          <a href="dependencies.html" title="Dependencies">
          <i class="none"></i>
        Dependencies</a>
            </li>
              </ul>
        </li>
                                                                                                                                                                                                                                      
      <li>
    
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <!-- Copyright 2010-2013 The MyBatis Team

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License. -->

  
    <div class="section"><h2>Introduction<a name="Introduction"></a></h2>
      <p>
      mybatis-velocity is an extension that allows you to use the Apache Velocity scripting language
      to generate your dynamic SQL queries on the fly.
      </p>
      <p>
        If you are not familiar with apache velocity, you can learn it from its documentation site:
        </p><ul>
          <li>
            <a class="externalLink" href="http://velocity.apache.org/engine/releases/velocity-1.7/vtl-reference-guide.html">Velocity Template Language (VTL) Reference</a>
          </li>
        </ul>
      
    </div>
    <div class="section"><h2>Install<a name="Install"></a></h2>
      <ol style="list-style-type: decimal">
        <li>
          <p>Put the mybatis-velocity-&lt;version&gt;.jar in your classpath.</p>
          <p>If you are using maven, just add a dependency to:
            </p><ul>
              <li>GroupId: org.mybatis.scripting</li>
              <li>ArtifactId: mybatis-velocity</li>
            </ul>
          
          <p></p>
        </li>
        <li>
          <p>Register the language driver alias in your mybatis configuration file:</p>
          <div class="source"><pre class="prettyprint">
&lt;configuration&gt;
  ...
  &lt;typeAliases&gt;
    &lt;typeAlias alias=&quot;velocity&quot; type=&quot;org.mybatis.scripting.velocity.Driver&quot;/&gt;
  &lt;/typeAliases&gt;
  ...
&lt;/configuration&gt;</pre></div>
        </li>
        <li>
          <p>Optional: Set the velocity as your default scripting language:</p>
          <div class="source"><pre class="prettyprint">
&lt;configuration&gt;
  ...
  &lt;settings&gt;
    &lt;setting name=&quot;defaultScriptingLanguage&quot; value=&quot;velocity&quot;/&gt;
  &lt;/settings&gt;
  ...
&lt;/configuration&gt;</pre></div>
        </li>
      </ol>

    </div>
    <div class="section"><h2>Usage<a name="Usage"></a></h2>
      <p>Just write your dynamic queries and use velocity:</p>
      <p>Example:
      </p><div class="source"><pre class="prettyprint">
&lt;select id=&quot;findPerson&quot; lang=&quot;velocity&quot;&gt;
  #set( $pattern = $_parameter.name + '%' )
  SELECT *
  FROM person
  WHERE name LIKE @{pattern, jdbcType=VARCHAR}
&lt;/select&gt;
      </pre></div>
      
      <p>
        Note:
        </p><ul>
          <li>#{...} syntax is replaced by @{...} syntax to avoid collisions with VTL</li>
        </ul>
      
    </div>
    <div class="section"><h2>Custom directives<a name="Custom_directives"></a></h2>
      <div class="section"><h3>trim<a name="trim"></a></h3>
        <div class="section"><div class="section"><h5>#trim( prefix prefixOverrides suffix suffixOverrides ) body #end<a name="atrim_prefix_prefixOverrides_suffix_suffixOverrides__body_end"></a></h5>
        <table border="0" class="table table-striped">
          <thead>
            <tr class="a">
              <th>Arg</th>
              <th>Description</th>
              <th>Type</th>
              <th>Default</th>
              <th>Example</th>
            </tr>
          </thead>
          <tbody>
            <tr class="b">
              <td>prefix</td>
              <td>Text to prepend if the body is not empty</td>
              <td>String</td>
              <td>Empty String</td>
              <td>&quot;WHERE &quot;</td>
            </tr>
            <tr class="a">
              <td>prefixOverrides</td>
              <td>Text to be removed from the body if it is at the beginning</td>
              <td>String list delimited by |</td>
              <td>Empty String</td>
              <td>&quot;AND |OR &quot;</td>
            </tr>
            <tr class="b">
              <td>suffix</td>
              <td>Text to appended if the body is not empty</td>
              <td>String</td>
              <td>Empty String</td>
              <td>&quot;] &quot;</td>
            </tr>
            <tr class="a">
              <td>suffixOverrides</td>
              <td>Text to be removed from the body if it is at the end</td>
              <td>String list delimited by |</td>
              <td>Empty String</td>
              <td>&quot;,&quot;</td>
            </tr>
          </tbody>
        </table>
      </div></div></div>
      <div class="section"><h3>where<a name="where"></a></h3>
        <div class="section"><div class="section"><h5>#where() body #end<a name="awhere_body_end"></a></h5>
        <p>Removes any AND or OR from the beginning, then if the result is not empty, prepends WHERE at the beginning</p>
      </div></div></div>
      <div class="section"><h3>mset<a name="mset"></a></h3>
        <div class="section"><div class="section"><h5>#mset() body #end<a name="amset_body_end"></a></h5>
        <p>Removes any &quot;,&quot; from the end, then if the result is not empty, prepends SET at the beginning</p>
      </div></div></div>
      <div class="section"><h3>repeat<a name="repeat"></a></h3>
        <div class="section"><div class="section"><h5>#repeat( collection  var  separator  open  close ) body #end<a name="arepeat_collection__var__separator__open__close__body_end"></a></h5>
        <p>
          Same as #foreach, but with special features:
          </p><ul>
            <li>Support for iterative parameter bindings via @{...} syntax</li>
            <li>Automatic separator and open/close string management</li>
          </ul>
        
        <table border="0" class="table table-striped">
          <thead>
            <tr class="a">
              <th>Arg</th>
              <th>Description</th>
              <th>Type</th>
              <th>Default</th>
              <th>Example</th>
            </tr>
          </thead>
          <tbody>
            <tr class="b">
              <td>collection</td>
              <td>List or array to iterate</td>
              <td>List or Array</td>
              <td>Empty List</td>
              <td>$_parameter.selectedIds</td>
            </tr>
            <tr class="a">
              <td>var</td>
              <td>Variable to be used in the loop</td>
              <td>Reference</td>
              <td></td>
              <td>$item</td>
            </tr>
            <tr class="b">
              <td>separator</td>
              <td>String to be inserted between iterations</td>
              <td>String</td>
              <td>Empty String</td>
              <td>&quot;,&quot;</td>
            </tr>
            <tr class="a">
              <td>open</td>
              <td>String to be prepended at the beginning</td>
              <td>String</td>
              <td>Empty String</td>
              <td>&quot;(&quot;</td>
            </tr>
            <tr class="b">
              <td>close</td>
              <td>String to be appended at the end</td>
              <td>String</td>
              <td>Empty String</td>
              <td>&quot;)&quot;</td>
            </tr>
          </tbody>
        </table>
        <p>Example:</p>
        <div class="source"><pre class="prettyprint">
SELECT *
FROM City
#where()
  #repeat( $_parameter.ids $id &quot;,&quot; &quot; state_id IN (&quot; &quot;)&quot; )
    @{id}
  #end
#end
        </pre></div>
      </div></div></div>
      <div class="section"><h3>in<a name="in"></a></h3>
        <div class="section"><div class="section"><h5>#in( collection  var  field ) body #end<a name="ain_collection__var__field__body_end"></a></h5>
        <p>
          Generates a SQL IN clause and breaks it into groups of 1000 items seperated by an OR clause to get around database limitations on the maximum number of items that can be handled. 
          It also supports iterative parameter bindings via @{...} syntax.
        </p>
        <table border="0" class="table table-striped">
          <thead>
            <tr class="a">
              <th>Arg</th>
              <th>Description</th>
              <th>Type</th>
              <th>Default</th>
              <th>Example</th>
            </tr>
          </thead>
          <tbody>
            <tr class="b">
              <td>collection</td>
              <td>List or array to iterate</td>
              <td>List or Array</td>
              <td>Empty List</td>
              <td>$_parameter.selectedIds</td>
            </tr>
            <tr class="a">
              <td>var</td>
              <td>Variable to be used in the loop</td>
              <td>Reference</td>
              <td></td>
              <td>$item</td>
            </tr>
            <tr class="b">
              <td>field</td>
              <td>Field name to be inserted before the IN clause</td>
              <td>String</td>
              <td>Empty String</td>
              <td>&quot;state_id&quot;</td>
            </tr>
          </tbody>
        </table>
        <p>Example:</p>
        <div class="source"><pre class="prettyprint">
SELECT *
FROM City
#where()
  #in( $_parameter.ids $id &quot;state_id&quot; )
    @{id}
  #end
#end
        </pre></div>
      </div></div></div>
    </div>
    <div class="section"><h2>User Defined Directives<a name="User_Defined_Directives"></a></h2>
      <p>
      mybatis-velocity allows you to write your own velocity directive:
      </p>
        <ul>
          <li>
             Create a property file named  mybatis-velocity.properties and put in on the classpath.
          </li>
          <li>
             Create your own velocity directive.
          </li>
          <li>
             Add the directive to the property file.
          </li>
         <li>
             Use the directive in the mapper xml file.
            <br />
          </li>
        </ul>
        <p>Example:</p>

        <div class="source"><pre class="prettyprint">
// User defined directive
package com.myproject.directives;

public class MyDirective extends Directive {
  
}

//mybatis-velocity.properties
userdirective=com.myproject.directives.MyDirective,com.myproject.directives.SpecialDirective;

// mapper xml file
SELECT *
FROM City
  #myDirective()
    ......
  #end
        </pre></div>

    </div>
    <div class="section"><h2>MyBatis specific syntax<a name="MyBatis_specific_syntax"></a></h2>
      <div class="section"><h3>Parameter Bindings<a name="Parameter_Bindings"></a></h3>
        <p>@{ property, attr1=val1, attr2=val2, ... }</p>
        <p>Where attrs must be any of: javaType, jdbcType, mode, numericScale, resultMap, typeHandler, jdbcTypeName</p>
      </div>
    </div>
  


                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2010-2013
                        <a href="http://www.mybatis.org/">MyBatis.org</a>.
            All Rights Reserved.      
                    
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
